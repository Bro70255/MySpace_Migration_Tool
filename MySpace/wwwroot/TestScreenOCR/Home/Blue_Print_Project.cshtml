@{
    ViewData["Title"] = "Blue print Project";
}

<div class="blueprint-flow">

    <!-- STEP INDICATOR -->
    <div class="flow-steps">
        <div class="step active">1 Upload</div>
        <div class="step">2 Review</div>
        <div class="step">3 Blueprint</div>
    </div>

    <!-- MAIN PANEL -->
    <div class="flow-body glass-body">

        <!-- STEP 1: UPLOAD -->
        <div class="flow-step active" id="step-upload">
            <h3>Upload Screens</h3>

            <div class="upload-zone" id="dropZone">
                <p>Drag & drop folder or images here</p>
                <span>or</span>

                <!-- Folder input -->
                <input type="file"
                       id="fileInput"
                       multiple
                       webkitdirectory
                       hidden
                       onchange="uploadScreenFolder('fileInput', 1)" />

                <button class="modern-btn" onclick="document.getElementById('fileInput').click()">
                    Browse Folder
                </button>
            </div>
        </div>

        <!-- STEP 2: TREE VIEW -->
        <div class="flow-step" id="step-review">
            <h3>Uploaded Structure</h3>
            <div class="tree-view" id="treeView"></div>

            <button class="modern-btn next-btn">Process Blueprint</button>
        </div>

        <!-- STEP 3: BLUEPRINT -->
        <div class="flow-step" id="step-blueprint">
            <h3>Blueprint Workspace</h3>
            <div class="blueprint-canvas">
                <p>Blueprint generation output appears here</p>
            </div>
        </div>

    </div>
</div>
<script>
    const steps = document.querySelectorAll(".flow-step");
    const stepHeaders = document.querySelectorAll(".step");

    function goStep(index) {
        steps.forEach(s => s.classList.remove("active"));
        stepHeaders.forEach(h => h.classList.remove("active"));

        steps[index].classList.add("active");
        stepHeaders[index].classList.add("active");
    }

    document.querySelector(".next-btn")?.addEventListener("click", () => {
        goStep(2);
    });

    // Drag & drop highlight only (folder drop is browser-limited)
    const dropZone = document.getElementById("dropZone");

    dropZone.addEventListener("dragover", e => {
        e.preventDefault();
        dropZone.style.borderColor = "#60a5fa";
    });

    dropZone.addEventListener("dragleave", () => {
        dropZone.style.borderColor = "#93c5fd";
    });

    dropZone.addEventListener("drop", e => {
        e.preventDefault();
        dropZone.style.borderColor = "#93c5fd";

        // Assign dropped files to input
        document.getElementById("fileInput").files = e.dataTransfer.files;

        // Call reusable function
        uploadScreenFolder("fileInput", 1);
    });
</script>
